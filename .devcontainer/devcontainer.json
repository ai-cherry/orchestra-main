{
  "name": "Cherry AI Orchestrator Dev Environment",
  "image": "mcr.microsoft.com/devcontainers/python:3.11",
  "features": {
    "ghcr.io/devcontainers/features/github-cli:1": {},
    "ghcr.io/devcontainers/features/docker-in-docker:2": {},
    "ghcr.io/devcontainers-contrib/features/pulumi:1": {},
    "ghcr.io/devcontainers/features/node:1": {
      "version": "20"
    }
  },
  "customizations": {
    "vscode": {
      "extensions": [
        "ms-python.python",
        "ms-python.vscode-pylance",
        "ms-python.black-formatter",
        "ms-python.isort",
        "ms-azuretools.vscode-docker",
        "eamodio.gitlens",
        "github.copilot",
        "github.copilot-chat",
        "github.vscode-github-actions",
        "redhat.vscode-yaml",
        "pulumi.pulumi",
        "ms-vscode.vscode-json",
        "bradlc.vscode-tailwindcss",
        "esbenp.prettier-vscode",
        "ms-vscode-remote.remote-containers",
        "ms-vscode.remote-explorer",
        "ms-toolsai.jupyter",
        "ms-toolsai.vscode-jupyter-cell-tags",
        "ms-toolsai.vscode-jupyter-slideshow",
        "ms-vscode.test-adapter-converter",
        "hbenl.vscode-test-explorer",
        "littlefoxteam.vscode-python-test-adapter",
        "donjayamanne.githistory",
        "mhutchie.git-graph",
        "streetsidesoftware.code-spell-checker",
        "ms-vscode.vscode-typescript-next",
        "formulahendry.auto-rename-tag",
        "christian-kohler.path-intellisense",
        "visualstudioexptteam.vscodeintellicode",
        "ms-vscode.vscode-ai-toolkit"
      ],
      "settings": {
        "python.defaultInterpreterPath": "/usr/local/bin/python",
        "python.formatting.provider": "none",
        "python.linting.enabled": true,
        "python.linting.pylintEnabled": false,
        "python.linting.flake8Enabled": true,
        "python.linting.mypyEnabled": true,
        "[python]": {
          "editor.defaultFormatter": "ms-python.black-formatter",
          "editor.formatOnSave": true,
          "editor.codeActionsOnSave": {
            "source.organizeImports": true
          }
        },
        "isort.args": ["--profile", "black"],
        "black-formatter.args": ["--line-length=88"],
        "editor.formatOnSave": true,
        "editor.codeActionsOnSave": {
          "source.organizeImports": true,
          "source.fixAll": true
        },
        "terminal.integrated.defaultProfile.linux": "bash",
        "terminal.integrated.profiles.linux": {
          "bash": {
            "path": "/bin/bash"
          }
        },
        "files.associations": {
          "*.env*": "dotenv",
          "*.yml": "yaml",
          "*.yaml": "yaml"
        },
        "github.copilot.enable": {
          "*": true,
          "yaml": true,
          "plaintext": false,
          "markdown": true,
          "python": true,
          "javascript": true,
          "typescript": true,
          "html": true,
          "css": true,
          "json": true
        },
        "github.copilot.advanced": {
          "debug.overrideEngine": "codex",
          "debug.testOverrideProxyUrl": "",
          "debug.overrideProxyUrl": ""
        },
        "workbench.colorTheme": "Default Dark+",
        "workbench.iconTheme": "vs-seti",
        "explorer.confirmDelete": false,
        "explorer.confirmDragAndDrop": false,
        "git.autofetch": true,
        "git.enableSmartCommit": true,
        "git.confirmSync": false,
        "extensions.autoUpdate": true,
        "telemetry.telemetryLevel": "off",
        "security.workspace.trust.untrustedFiles": "open"
      }
    }
  },
  "postCreateCommand": "sudo apt-get update && sudo apt-get install -y curl redis-server && python -m pip install --upgrade pip && pip install -r requirements-dev.txt && chmod +x ./.devcontainer/setup_env.sh && echo 'Cherry AI Dev container creation complete. Dependencies installed and setup script made executable.'",
  "postStartCommand": "bash ./.devcontainer/setup_env.sh && source /tmp/devcontainer_exports.sh && echo '\n# Load Cherry AI Environment Variables\nsource /tmp/devcontainer_exports.sh' >> ~/.bashrc && echo '\n# Load Cherry AI Environment Variables\nsource /tmp/devcontainer_exports.sh' >> ~/.bash_profile && redis-server --daemonize yes && echo 'Cherry AI environment configured and Redis started. Check /tmp/devcontainer_exports.sh for details.'",
  "remoteEnv": {
    "PATH": "${containerEnv:PATH}:${containerEnv:HOME}/.local/bin",
    "PYTHONPATH": "${containerWorkspaceFolder}:${containerWorkspaceFolder}/mcp_server",
    "CHERRY_AI_ENV": "development",
    "MCP_SERVER_HOST": "0.0.0.0",
    "REDIS_URL": "redis://localhost:6379"
  },
  "containerEnv": {
    "HTTP_PROXY": "http://http.docker.internal:3128",
    "HTTPS_PROXY": "http://http.docker.internal:3128",
    "NO_PROXY": "localhost,127.0.0.1,.internal,redis"
  },
  "mounts": [
    "source=${localEnv:HOME}/.config/gcloud,target=/home/vscode/.config/gcloud,type=bind,consistency=cached",
    "source=${localWorkspaceFolder}/.pulumi,target=/workspace/.pulumi,type=bind,consistency=cached",
    "source=${localWorkspaceFolder}/.ai-tools,target=/workspace/.ai-tools,type=bind,consistency=cached"
  ],
  "forwardPorts": [
    8000,
    8001,
    8002,
    8003,
    8004,
    8005,
    8006,
    8007,
    8008,
    6379
  ],
  "portsAttributes": {
    "8000": {
      "label": "Cherry AI Admin Interface",
      "onAutoForward": "notify"
    },
    "8001": {
      "label": "Cherry Personal API",
      "onAutoForward": "silent"
    },
    "8002": {
      "label": "Sophia Business API", 
      "onAutoForward": "silent"
    },
    "8003": {
      "label": "Karen Healthcare API",
      "onAutoForward": "silent"
    },
    "8004": {
      "label": "Infrastructure Manager",
      "onAutoForward": "silent"
    },
    "8005": {
      "label": "Database Manager",
      "onAutoForward": "silent"
    },
    "8006": {
      "label": "MCP Tools Server",
      "onAutoForward": "silent"
    },
    "8007": {
      "label": "MCP Code Intelligence",
      "onAutoForward": "silent"
    },
    "8008": {
      "label": "MCP Git Intelligence",
      "onAutoForward": "silent"
    },
    "6379": {
      "label": "Redis Server",
      "onAutoForward": "silent"
    }
  }
}

