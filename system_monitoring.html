<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Monitoring - Cherry AI</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #ffffff;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #ff6b9d, #4ecdc4, #45b7d1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-bar {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px 30px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            backdrop-filter: blur(10px);
        }

        .nav-links {
            display: flex;
            gap: 20px;
        }

        .nav-link {
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .nav-link:hover, .nav-link.active {
            background: rgba(78, 205, 196, 0.3);
            color: white;
        }

        .metrics-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }

        .metric-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .metric-label {
            font-size: 1rem;
            opacity: 0.8;
        }

        .metric-trend {
            font-size: 0.9rem;
            margin-top: 8px;
            font-weight: 600;
        }

        .trend-up {
            color: #43e97b;
        }

        .trend-down {
            color: #ff6b6b;
        }

        .trend-stable {
            color: #ffa726;
        }

        .monitoring-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
        }

        .chart-canvas {
            width: 100%;
            height: 300px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            position: relative;
            overflow: hidden;
        }

        .chart-line {
            position: absolute;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, #4ecdc4, #45b7d1);
            animation: pulse-line 2s infinite;
        }

        @keyframes pulse-line {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        .alerts-panel {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
        }

        .alert-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid;
            transition: all 0.3s ease;
        }

        .alert-item:hover {
            transform: translateX(5px);
        }

        .alert-critical {
            border-left-color: #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
        }

        .alert-warning {
            border-left-color: #ffa726;
            background: rgba(255, 167, 38, 0.1);
        }

        .alert-info {
            border-left-color: #4ecdc4;
            background: rgba(78, 205, 196, 0.1);
        }

        .service-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .service-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
        }

        .service-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .service-name {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .status-online {
            background: #43e97b;
            box-shadow: 0 0 10px rgba(67, 233, 123, 0.5);
        }

        .status-warning {
            background: #ffa726;
            box-shadow: 0 0 10px rgba(255, 167, 38, 0.5);
        }

        .status-offline {
            background: #ff6b6b;
            box-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 3px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4ecdc4, #45b7d1);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #43e97b, #38f9d7);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .log-viewer {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
        }

        .log-content {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 10px;
            padding: 20px;
            height: 300px;
            overflow-y: auto;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9rem;
        }

        .log-entry {
            margin-bottom: 5px;
            padding: 5px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .log-timestamp {
            color: #4ecdc4;
            font-weight: 600;
        }

        .log-level {
            font-weight: 600;
            width: 70px;
            display: inline-block;
        }

        .log-level.error {
            color: #ff6b6b;
        }

        .log-level.warning {
            color: #ffa726;
        }

        .log-level.info {
            color: #43e97b;
        }

        .refresh-indicator {
            display: none;
            color: #4ecdc4;
            font-size: 0.9rem;
        }

        .refresh-indicator.active {
            display: inline;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä System Monitoring</h1>
            <p>Real-time system health and performance metrics</p>
        </div>

        <div class="nav-bar">
            <div class="nav-links">
                <a href="/cherry_ultimate_interface.html" class="nav-link">üè† Dashboard</a>
                <a href="/agent_factory.html" class="nav-link">ü§ñ Agent Factory</a>
                <a href="/system_monitoring.html" class="nav-link active">üìä System Monitor</a>
                <a href="/orchestrator_management.html" class="nav-link">üé≠ Orchestrator</a>
            </div>
            <div>
                <span class="refresh-indicator" id="refresh-indicator">üîÑ</span>
                Last updated: <span id="last-updated">Loading...</span>
            </div>
        </div>

        <div class="metrics-overview">
            <div class="metric-card">
                <div class="metric-value" id="cpu-usage">24%</div>
                <div class="metric-label">CPU Usage</div>
                <div class="metric-trend trend-stable" id="cpu-trend">‚Üó +2%</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="memory-usage">1.8GB</div>
                <div class="metric-label">Memory Usage</div>
                <div class="metric-trend trend-up" id="memory-trend">‚Üó +5%</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="api-requests">2,847</div>
                <div class="metric-label">API Requests/hr</div>
                <div class="metric-trend trend-up" id="api-trend">‚Üó +12%</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="response-time">156ms</div>
                <div class="metric-label">Avg Response</div>
                <div class="metric-trend trend-down" id="response-trend">‚Üò -8ms</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="active-sessions">47</div>
                <div class="metric-label">Active Sessions</div>
                <div class="metric-trend trend-up" id="sessions-trend">‚Üó +3</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="system-uptime">99.2%</div>
                <div class="metric-label">System Uptime</div>
                <div class="metric-trend trend-stable" id="uptime-trend">‚Üí Stable</div>
            </div>
        </div>

        <div class="monitoring-grid">
            <div class="chart-container">
                <h3>Performance Metrics</h3>
                <div class="chart-canvas" id="performance-chart">
                    <div class="chart-line" style="top: 20%; animation-delay: 0s;"></div>
                    <div class="chart-line" style="top: 40%; animation-delay: 0.5s;"></div>
                    <div class="chart-line" style="top: 60%; animation-delay: 1s;"></div>
                </div>
                <p style="margin-top: 15px; opacity: 0.8;">Real-time system performance visualization</p>
            </div>

            <div class="alerts-panel">
                <h3>System Alerts</h3>
                <div id="alerts-container">
                    <div class="alert-item alert-warning">
                        <strong>‚ö†Ô∏è High Memory Usage</strong>
                        <p>Memory usage at 85% - consider optimization</p>
                        <small>2 minutes ago</small>
                    </div>
                    <div class="alert-item alert-info">
                        <strong>‚ÑπÔ∏è API Rate Increase</strong>
                        <p>API requests increased by 15% in last hour</p>
                        <small>5 minutes ago</small>
                    </div>
                    <div class="alert-item alert-critical">
                        <strong>üö® MCP Server Timeout</strong>
                        <p>Memory MCP server experiencing timeouts</p>
                        <small>8 minutes ago</small>
                    </div>
                </div>
            </div>
        </div>

        <div class="service-status">
            <div class="service-card">
                <div class="service-header">
                    <span class="service-name">üçí Cherry AI API</span>
                    <span class="status-indicator status-online" id="api-status"></span>
                </div>
                <p>Port: 8000 | Response: 142ms</p>
                <p>Requests: 1,247/hr | Errors: 2</p>
                <div style="margin-top: 15px;">
                    <button class="btn btn-success" onclick="testService('api')">Test API</button>
                    <button class="btn btn-primary" onclick="restartService('api')">Restart</button>
                </div>
            </div>

            <div class="service-card">
                <div class="service-header">
                    <span class="service-name">üß† Memory MCP Server</span>
                    <span class="status-indicator status-warning" id="memory-mcp-status"></span>
                </div>
                <p>Port: 8003 | Response: 234ms</p>
                <p>Connections: 12 | Timeout: 3</p>
                <div style="margin-top: 15px;">
                    <button class="btn btn-success" onclick="testService('memory-mcp')">Test MCP</button>
                    <button class="btn btn-primary" onclick="restartService('memory-mcp')">Restart</button>
                </div>
            </div>

            <div class="service-card">
                <div class="service-header">
                    <span class="service-name">üõ†Ô∏è Tools MCP Server</span>
                    <span class="status-indicator status-offline" id="tools-mcp-status"></span>
                </div>
                <p>Port: 8006 | Response: N/A</p>
                <p>Status: Not Running</p>
                <div style="margin-top: 15px;">
                    <button class="btn btn-success" onclick="startService('tools-mcp')">Start</button>
                    <button class="btn btn-danger" onclick="stopService('tools-mcp')">Stop</button>
                </div>
            </div>

            <div class="service-card">
                <div class="service-header">
                    <span class="service-name">üóÑÔ∏è PostgreSQL</span>
                    <span class="status-indicator status-online" id="postgres-status"></span>
                </div>
                <p>Version: 15.3 | Connections: 8/100</p>
                <p>Queries: 456/sec | Size: 2.3GB</p>
                <div style="margin-top: 15px;">
                    <button class="btn btn-success" onclick="checkDatabase('postgres')">Check DB</button>
                    <button class="btn btn-primary" onclick="optimizeDatabase('postgres')">Optimize</button>
                </div>
            </div>

            <div class="service-card">
                <div class="service-header">
                    <span class="service-name">‚ö° Redis Cache</span>
                    <span class="status-indicator status-online" id="redis-status"></span>
                </div>
                <p>Memory: 245MB | Keys: 1,247</p>
                <p>Hit Rate: 94.2% | Ops/sec: 1,234</p>
                <div style="margin-top: 15px;">
                    <button class="btn btn-success" onclick="flushCache('redis')">Flush Cache</button>
                    <button class="btn btn-primary" onclick="optimizeCache('redis')">Optimize</button>
                </div>
            </div>

            <div class="service-card">
                <div class="service-header">
                    <span class="service-name">üîç Weaviate Vector DB</span>
                    <span class="status-indicator status-online" id="weaviate-status"></span>
                </div>
                <p>Objects: 15,678 | Memory: 512MB</p>
                <p>Queries: 89/min | Avg: 45ms</p>
                <div style="margin-top: 15px;">
                    <button class="btn btn-success" onclick="queryVectorDB('weaviate')">Query DB</button>
                    <button class="btn btn-primary" onclick="reindexVectorDB('weaviate')">Reindex</button>
                </div>
            </div>
        </div>

        <div class="log-viewer">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3>System Logs</h3>
                <div>
                    <button class="btn btn-primary" onclick="refreshLogs()">üîÑ Refresh</button>
                    <button class="btn btn-success" onclick="downloadLogs()">üì• Download</button>
                </div>
            </div>
            <div class="log-content" id="log-content">
                <!-- Logs will be loaded here -->
            </div>
        </div>
    </div>

    <script>
        let refreshInterval;
        let logUpdateInterval;

        // System monitoring functions
        function updateMetrics() {
            document.getElementById('refresh-indicator').classList.add('active');
            
            // Simulate metric updates
            setTimeout(() => {
                document.getElementById('cpu-usage').textContent = Math.floor(Math.random() * 40 + 20) + '%';
                document.getElementById('memory-usage').textContent = (Math.random() * 2 + 1).toFixed(1) + 'GB';
                document.getElementById('api-requests').textContent = (Math.floor(Math.random() * 1000) + 2000).toLocaleString();
                document.getElementById('response-time').textContent = Math.floor(Math.random() * 100 + 100) + 'ms';
                document.getElementById('active-sessions').textContent = Math.floor(Math.random() * 20 + 40);
                
                document.getElementById('last-updated').textContent = new Date().toLocaleTimeString();
                document.getElementById('refresh-indicator').classList.remove('active');
            }, 1000);
        }

        function testService(serviceName) {
            console.log(`Testing ${serviceName} service...`);
            
            if (serviceName === 'api') {
                fetch('/api/health')
                    .then(response => {
                        if (response.ok) {
                            alert('‚úÖ Cherry AI API is responding correctly');
                            document.getElementById('api-status').className = 'status-indicator status-online';
                        } else {
                            alert('‚ö†Ô∏è Cherry AI API responded with error');
                            document.getElementById('api-status').className = 'status-indicator status-warning';
                        }
                    })
                    .catch(error => {
                        alert('‚ùå Cherry AI API is not responding');
                        document.getElementById('api-status').className = 'status-indicator status-offline';
                    });
            } else {
                alert(`Testing ${serviceName}... (Feature coming soon)`);
            }
        }

        function restartService(serviceName) {
            console.log(`Restarting ${serviceName} service...`);
            alert(`Restarting ${serviceName} service... (Feature coming soon)`);
        }

        function startService(serviceName) {
            console.log(`Starting ${serviceName} service...`);
            alert(`Starting ${serviceName} service... (Feature coming soon)`);
        }

        function stopService(serviceName) {
            console.log(`Stopping ${serviceName} service...`);
            alert(`Stopping ${serviceName} service... (Feature coming soon)`);
        }

        function checkDatabase(dbName) {
            console.log(`Checking ${dbName} database...`);
            alert(`Database health check for ${dbName}... (Feature coming soon)`);
        }

        function optimizeDatabase(dbName) {
            console.log(`Optimizing ${dbName} database...`);
            alert(`Optimizing ${dbName} database... (Feature coming soon)`);
        }

        function flushCache(cacheName) {
            console.log(`Flushing ${cacheName} cache...`);
            alert(`Flushing ${cacheName} cache... (Feature coming soon)`);
        }

        function optimizeCache(cacheName) {
            console.log(`Optimizing ${cacheName} cache...`);
            alert(`Optimizing ${cacheName} cache... (Feature coming soon)`);
        }

        function queryVectorDB(dbName) {
            console.log(`Querying ${dbName} vector database...`);
            alert(`Querying ${dbName} vector database... (Feature coming soon)`);
        }

        function reindexVectorDB(dbName) {
            console.log(`Reindexing ${dbName} vector database...`);
            alert(`Reindexing ${dbName} vector database... (Feature coming soon)`);
        }

        function loadSystemLogs() {
            const logContent = document.getElementById('log-content');
            const logs = [
                { time: new Date().toLocaleTimeString(), level: 'INFO', message: 'System health check completed successfully' },
                { time: new Date(Date.now() - 60000).toLocaleTimeString(), level: 'WARNING', message: 'Memory usage approaching 80% threshold' },
                { time: new Date(Date.now() - 120000).toLocaleTimeString(), level: 'INFO', message: 'Cherry AI API: 1000 requests processed in last hour' },
                { time: new Date(Date.now() - 180000).toLocaleTimeString(), level: 'ERROR', message: 'MCP Memory Server: Connection timeout on port 8003' },
                { time: new Date(Date.now() - 240000).toLocaleTimeString(), level: 'INFO', message: 'PostgreSQL: Database optimization completed' },
                { time: new Date(Date.now() - 300000).toLocaleTimeString(), level: 'INFO', message: 'Redis cache: Hit rate improved to 94.2%' },
                { time: new Date(Date.now() - 360000).toLocaleTimeString(), level: 'WARNING', message: 'High API request rate detected from IP 192.168.1.100' },
                { time: new Date(Date.now() - 420000).toLocaleTimeString(), level: 'INFO', message: 'Weaviate: Indexed 500 new vector embeddings' }
            ];

            logContent.innerHTML = logs.map(log => `
                <div class="log-entry">
                    <span class="log-timestamp">${log.time}</span>
                    <span class="log-level ${log.level.toLowerCase()}">${log.level}</span>
                    ${log.message}
                </div>
            `).join('');
        }

        function refreshLogs() {
            loadSystemLogs();
            console.log('Logs refreshed');
        }

        function downloadLogs() {
            alert('üì• Downloading system logs... (Feature coming soon)');
        }

        // Add new log entries periodically
        function addRealtimeLog() {
            const logContent = document.getElementById('log-content');
            const logLevels = ['INFO', 'WARNING', 'ERROR'];
            const messages = [
                'API request processed successfully',
                'Memory usage check completed',
                'Database query executed',
                'Cache hit recorded',
                'WebSocket connection established',
                'Agent task completed',
                'System health check passed',
                'Performance metrics updated'
            ];

            const newLog = {
                time: new Date().toLocaleTimeString(),
                level: logLevels[Math.floor(Math.random() * 3)],
                message: messages[Math.floor(Math.random() * messages.length)]
            };

            const logDiv = document.createElement('div');
            logDiv.className = 'log-entry';
            logDiv.innerHTML = `
                <span class="log-timestamp">${newLog.time}</span>
                <span class="log-level ${newLog.level.toLowerCase()}">${newLog.level}</span>
                ${newLog.message}
            `;

            logContent.insertBefore(logDiv, logContent.firstChild);

            // Keep only last 50 entries
            while (logContent.children.length > 50) {
                logContent.removeChild(logContent.lastChild);
            }
        }

        // Initialize
        window.addEventListener('load', function() {
            loadSystemLogs();
            updateMetrics();

            // Update metrics every 10 seconds
            refreshInterval = setInterval(updateMetrics, 10000);

            // Add new log entries every 5 seconds
            logUpdateInterval = setInterval(addRealtimeLog, 5000);

            // Test API on load
            testService('api');
        });

        // Cleanup intervals when leaving page
        window.addEventListener('beforeunload', function() {
            if (refreshInterval) clearInterval(refreshInterval);
            if (logUpdateInterval) clearInterval(logUpdateInterval);
        });
    </script>
</body>
</html> 