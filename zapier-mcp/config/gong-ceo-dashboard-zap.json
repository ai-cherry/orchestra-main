{
  "zap_name": "Gong CEO Intelligence Pipeline",
  "description": "Automatically analyze Gong.io calls for CEO business intelligence insights",
  "trigger": {
    "app": "gong",
    "event": "call_completed",
    "conditions": {
      "duration_minutes": ">= 15",
      "has_transcript": true,
      "participants": {
        "includes_client": true,
        "includes_internal": true
      }
    },
    "webhook_url": "http://192.9.142.8:8001/api/v1/triggers/gong-call-completed"
  },
  "actions": [
    {
      "step": 1,
      "action": "cursor_ai_analysis",
      "description": "Analyze call transcript for CEO insights",
      "endpoint": "http://192.9.142.8:8001/api/v1/actions/analyze-gong-call",
      "data": {
        "call_id": "{{trigger.call_id}}",
        "transcript": "{{trigger.transcript}}",
        "participants": "{{trigger.participants}}",
        "analysis_type": "ceo_intelligence",
        "focus_areas": [
          "sales_coaching",
          "client_sentiment",
          "competitive_mentions",
          "deal_health",
          "risk_assessment"
        ]
      }
    },
    {
      "step": 2,
      "action": "sophia_ai_processing",
      "description": "Generate executive summary via Sophia persona",
      "endpoint": "http://192.9.142.8:8014/api/v1/sophia/analyze-call",
      "data": {
        "call_analysis": "{{step1.analysis_results}}",
        "output_format": "executive_summary",
        "recipient": "ceo",
        "include_recommendations": true
      }
    },
    {
      "step": 3,
      "action": "conditional_alert",
      "description": "Send Slack alert for high-priority insights",
      "conditions": {
        "deal_health_score": "< 70",
        "competitive_threat": "= true",
        "client_risk": "> medium"
      },
      "slack_webhook": "{{env.SLACK_CEO_WEBHOOK}}",
      "message_template": {
        "channel": "#ceo-alerts",
        "text": "ðŸš¨ **High Priority Call Analysis**",
        "attachments": [
          {
            "color": "warning",
            "fields": [
              {
                "title": "Call Details",
                "value": "Client: {{trigger.client_name}}\nRep: {{trigger.rep_name}}\nDuration: {{trigger.duration}} min",
                "short": true
              },
              {
                "title": "Risk Assessment",
                "value": "Health Score: {{step1.deal_health_score}}/100\nRisk Level: {{step1.risk_level}}",
                "short": true
              },
              {
                "title": "Key Insights",
                "value": "{{step2.executive_summary}}",
                "short": false
              },
              {
                "title": "Recommended Actions",
                "value": "{{step2.recommendations}}",
                "short": false
              }
            ]
          }
        ]
      }
    },
    {
      "step": 4,
      "action": "update_salesforce",
      "description": "Update Salesforce opportunity with call insights",
      "app": "salesforce",
      "object": "Opportunity",
      "operation": "update",
      "search_field": "Account_Name__c",
      "search_value": "{{trigger.client_name}}",
      "update_fields": {
        "Last_Call_Health_Score__c": "{{step1.deal_health_score}}",
        "Call_Analysis_Summary__c": "{{step2.executive_summary}}",
        "Risk_Factors__c": "{{step1.risk_factors}}",
        "Competitive_Threats__c": "{{step1.competitive_mentions}}",
        "Next_Actions__c": "{{step2.recommendations}}",
        "Last_Analysis_Date__c": "{{today}}"
      }
    },
    {
      "step": 5,
      "action": "store_analytics",
      "description": "Store analysis results for trending and reporting",
      "endpoint": "http://192.9.142.8:8001/api/v1/actions/store-ceo-analytics",
      "data": {
        "call_id": "{{trigger.call_id}}",
        "analysis_date": "{{today}}",
        "deal_health_score": "{{step1.deal_health_score}}",
        "client_sentiment": "{{step1.client_sentiment}}",
        "rep_performance": "{{step1.rep_performance}}",
        "competitive_mentions": "{{step1.competitive_mentions}}",
        "executive_summary": "{{step2.executive_summary}}",
        "tags": ["ceo_dashboard", "sales_intelligence", "call_analysis"]
      }
    }
  ],
  "error_handling": {
    "retry_attempts": 3,
    "retry_delay": "30s",
    "fallback_actions": [
      {
        "action": "log_error",
        "destination": "http://192.9.142.8:8001/api/v1/errors/log"
      },
      {
        "action": "notify_admin",
        "method": "email",
        "recipient": "admin@payready.com",
        "template": "zap_failure_notification"
      }
    ]
  },
  "schedule": {
    "frequency": "immediate",
    "timeout": "300s",
    "rate_limit": "30_per_hour"
  },
  "testing": {
    "sample_data": {
      "call_id": "gong_call_12345",
      "client_name": "Acme Corporation",
      "rep_name": "Sarah Johnson",
      "duration": 45,
      "transcript": "Sample call transcript for testing...",
      "participants": [
        {"name": "Sarah Johnson", "email": "sarah@payready.com", "type": "internal"},
        {"name": "John Smith", "email": "john@acme.com", "type": "client"}
      ]
    },
    "expected_outcomes": {
      "sophia_analysis": "Generated executive summary",
      "salesforce_update": "Opportunity updated with call insights",
      "slack_notification": "CEO alert sent if conditions met"
    }
  },
  "integration_urls": {
    "webhook_setup": "https://zapier.com/developer/builder/app/{{app_id}}/authentication",
    "testing": "https://zapier.com/developer/builder/app/{{app_id}}/versions/{{version}}/test",
    "deployment": "https://zapier.com/developer/builder/app/{{app_id}}/versions/{{version}}/promote"
  },
  "ceo_dashboard_metrics": {
    "track": [
      "total_calls_analyzed",
      "average_deal_health_score",
      "competitive_threats_detected",
      "at_risk_opportunities",
      "rep_performance_trends"
    ],
    "reporting_frequency": "daily",
    "dashboard_url": "http://192.9.142.8:8010/ceo-dashboard"
  }
} 