# Trivy Configuration File

# Vulnerability scanning
vulnerability:
  # Skip dev dependencies for vulnerability scanning to focus on production issues
  ignore-unfixed: false
  # Report vulnerabilities with severity level Medium and higher
  severity: MEDIUM,HIGH,CRITICAL
  # Don't scan test directories
  skip-dirs:
    - tests
    - test-data
    - examples
    - docs
  # Only scan Python packages for vulnerabilities since this is a Python project
  targets:
    - python-pkg

# Misconfiguration scanning
misconfiguration:
  # Use recommended policies
  policy-bundle: "/bundle/policies"
  # Report misconfigurations with severity level Medium and higher
  severity: MEDIUM,HIGH,CRITICAL
  # Skip specific checks that generate false positives in CI environment
  skip-checks:
    - AVD-AWS-0086
    - AVD-GCP-0049

# Secret scanning
secret:
  # Enable secret scanning
  enable: true
  # Skip specific patterns known to generate false positives
  disable-patters:
    - dummy credential patterns

# File System Scanning specific options
filesystem:
  # Skip directories in .gitignore
  skip-dirs-from-gitignore: true
  # Include Python and YAML files for scanning
  include:
    - "**/*.py"
    - "**/*.yaml"
    - "**/*.yml"
  # Exclude common third-party code directories
  exclude:
    - "**/node_modules/"
    - "**/venv/"
    - "**/.venv/"
    - "**/google-cloud-sdk/"
  
# Output customization
report:
  # Sort findings by severity
  sort-by: severity
  # Include detailed information about vulnerabilities
  include-non-failures: true
  # Format output in SARIF and JSON for processing
  format: sarif
  # Ignore specific vulnerabilities that are known and accepted risks
  ignore-file: .trivyignore

# GitHub specific settings
github:
  # Enable GitHub integration
  enable: true