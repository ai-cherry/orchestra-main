---
description:
globs:
alwaysApply: true
---
\
\\
---
description: Standards for Pulumi Python IaC on Lambda Labs for Project Symphony, focusing on VPS deployments and local state backend.
globs: ["infra/**/*.py", "**/Pulumi.yaml", "**/Pulumi.*.yaml"]
autoAttach: true
---

**Pulumi Lambda Labs Standards:**
- **Language:** Use Pulumi with Python SDK (`pulumi_Lambda Labs`).
- **Idempotency:** All stacks must be idempotent.
- **State Backend:** Local file system or S3-compatible storage.
- **Config:** Use Pulumi stack configuration for environment-specific values. Use environment variables for sensitive values.
- **Components:** Structure resources into reusable Pulumi Components where appropriate.
- **Naming:** Follow consistent naming conventions for resources.
- **Secrets in Pulumi:** For secrets managed *by* Pulumi (e.g., a generated DB password), use `pulumi.Output.secret()` and `pulumi config set --secret`.
- **VPS Specifics**: When defining Lambda Labs instances, ensure appropriate settings for CPU, memory, and storage based on expected workload. Always include startup scripts for initial configuration.
- **IAM Best Practices**: Use API keys with minimal required permissions. Store API keys securely and rotate regularly.
